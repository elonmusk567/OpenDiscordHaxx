<script>
    function Submit() {
        SendJSON({ 'op': 'join', 'invite': document.getElementById('invite').value,
                                 'anti_track': document.getElementById('track').value == 'on',
                                 'threads': document.getElementById('thread-amount').value });
    }


    function CheckInvite(invite) {
        const splitted = invite.value.split('/');
        const invite_code = splitted.length > 0 ? splitted[splitted.length - 1] : splitted[0];

        const req = new XMLHttpRequest();
        req.open("GET", 'https://discordapp.com/api/v6/invite/' + invite_code + '?with_counts=true');
        req.send();

        req.onreadystatechange = function() {
          if (this.readyState == 4) {
            if (this.status == 200)
              HandleInvite(this.responseText);
            else
              document.getElementById('invite-preview').style.display = 'none';
          }
        }
    }
</script>


<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" style="height: 100%">
<head>
    <!-- Other shit -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial scale=1.0">
    <link rel="Icon" type="image/x-icon" href="../Images/Anarchy.png">
    <title>Joiner - OpenDH</title>


    <!-- CSS -->
    <link rel="stylesheet" href="../css/ODH.css">
    <link rel="stylesheet" href="../css/Input-fix.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">


    <!-- JS -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="../js/Toast.js"></script>
    <script src="../js/Error.js"></script>
    <script src="../js/RaidBot.js"></script>
    <script src="../js/InvitePreview.js"></script>
</head>

<nav id="odh-nav" class="navbar navbar-inverse" style="border: none">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" style="font-family: Roboto;" href="../Dashboard.html">DiscordHaxx</a>
      </div>
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown">Management<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../Dashboard.html">Dashboard</a></li>
            <li><a href="List.html">Bots</a></li>
          </ul>
        </li>
        <li class="dropdown active">
            <a class="dropdown-toggle" data-toggle="dropdown">Start attack<span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="Joiner.html">Joiner</a></li>
                <li><a href="Leaver.html">Leaver</a></li>
                <li><a href="Flooder.html">Flooder</a></li>
                <li><a href="Friender.html">Friender</a></li>
                <li><a href="Reactions.html">Reactions</a></li>
                <li><a href="VCSpammer.html">VC spammer</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown">Tools<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="../Tools/Checker.html">Checker</a></li>
              <li><a href="../Tools/Cleaner.html">Cleaner</a></li>
              <li><a href="../Tools/Recon.html">Server recon</a></li>
            </ul>
        </li>
    </ul>
  </div>
  </nav>


<body class="dark-body">
      <h1 class="dark-title" style="margin-top: 40px;">Joiner</h1>
      <br>

      <input class="form-control dark-input center-block" style="width: 340px;" placeholder="Invite" id="invite" oninput="CheckInvite(this)">
      <br>
      <div class="center-block" style="width: 85px">
        <input type="checkbox" id="track" checked>
        <label style="color: rgb(210,212,215); font-size: 16px; font-weight: 300;" for="track">Anti-track</label>
      </div>
      <br>

      <button class="btn dark-btn center-block" style="width: 240px;" onclick="Submit()">Start</button>

      <div id="invite-preview" class="form-control dark-container" style="width: 400px; height: 250px; position: absolute; bottom: 10px; left: 10px; display: none">

        <style>
          .p {
            color: rgb(230,252,255); 
            font-size: 14px;
          }  
        </style>


        <div id="guild-invite-preview" style="width: 100%; height: 100%; display: none">
          <p class="dark-title" style="font-size: 33px">Guild</p>
          <div style="margin-top: -10px">
            <hr>
  
            <p id="guild-preview-name">Name: Guild name</p>
            <p id="guild-preview-verification">Verification level: None</p>
            <p id="guild-preview-members">Members: Amount of members</p>
          </div>
        </div>

        <div id="group-invite-preview" style="width: 100%; height: 100%; display: none">
          <p class="dark-title" style="font-size: 33px">Group</p>
          <div style="margin-top: -10px">
            <hr>
  
            <p id="group-preview-name">Name: Group name</p>
            <p id="group-preview-recipients">Recipients: Amount of recipients</p>
            <p id="group-preview-inviter">Inviter: not ilinked<span style="color: rgb(200,202,205); margin-left: 2px">#1337</span></p>
          </div>
        </div>
      </div>

      <input type="number" min="1" max="2000" class="form-control dark-input" placeholder="Threads" id="thread-amount">
</body>
</html>